<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generalised Link Transformation — glt • semEff</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Generalised Link Transformation — glt" />
<meta property="og:description" content="Transform a numeric variable using a GLM link function, or
return an estimate of same." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semEff</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/semEff.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/predicting-effects.html">Predicting Effects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/murphymv/semEff/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalised Link Transformation</h1>
    <small class="dont-index">Source: <a href='https://github.com/murphymv/semEff/blob/master/R/stdEff-fun.R'><code>R/stdEff-fun.R</code></a></small>
    <div class="hidden name"><code>glt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Transform a numeric variable using a GLM link function, or
return an estimate of same.</p>
    </div>

    <pre class="usage"><span class='fu'>glt</span><span class='op'>(</span><span class='va'>x</span>, family <span class='op'>=</span> <span class='cn'>NULL</span>, force.est <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a positive numeric vector, corresponding to a variable to be
transformed. Can also be a list or nested list of such vectors.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Optional, the error distribution family containing the link
function which will be used to transform <code>x</code> (see <code><a href='https://rdrr.io/r/stats/family.html'>family()</a></code> for
specification details). If not supplied, it is determined from <code>x</code> (see
Details).</p></td>
    </tr>
    <tr>
      <th>force.est</th>
      <td><p>Logical, whether to force the return of the estimated rather
than direct transformation, where the latter is available (i.e. does not
contain undefined values).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric vector of the transformed values, or an array, list of
vectors/arrays, or nested list.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>glt()</code> can be used to provide a 'generalised' transformation of a
numeric variable, using the link function from a generalised linear model
(GLM) fit to the variable. The transformation is generalised in the sense
that it can extend even to cases where a standard link transformation would
produce undefined values. It achieves this by using an estimate based on
the 'working' response variable of the GLM (see below). If the error
distribution <code>family</code> is not specified (default), then it is determined
(roughly) from <code>x</code>, with <code><a href='https://rdrr.io/r/stats/family.html'>binomial(link = "logit")</a></code> used when all x &lt;= 1
and <code><a href='https://rdrr.io/r/stats/family.html'>poisson(link = "log")</a></code> otherwise. Although the function is generally
intended for variables with a binomial or Poisson distribution, any
variable which can be fit using <code><a href='https://rdrr.io/r/stats/glm.html'>glm()</a></code> can be supplied. One of the key
purposes of <code>glt()</code> is to allow the calculation of fully standardised
effects (coefficients) for GLMs (in which case <code>x</code> = the response
variable), while it can also facilitate the proper calculation of SEM
indirect effects (see below).</p>
<p><strong>Estimating the direct link transformation</strong></p>
<p>A key challenge in generating fully standardised effects for a GLM with a
non-gaussian link function is the difficulty in calculating appropriate
standardised ranges (typically the standard deviation) for the response
variable in the link scale. This is because a direct transformation of the
response will often produce undefined values. Although methods for
circumventing this issue by indirectly estimating the variance of the
response on the link scale have been proposed – including a
latent-theoretic approach for binomial models (McKelvey &amp; Zavoina 1975) and
a more general variance-based method using pseudo R-squared (Menard 2011) —
here an alternative approach is used. Where transformed values are
undefined, the function will instead return the synthetic 'working'
response from the iteratively reweighted least squares (IRLS) algorithm of
the GLM (McCullagh &amp; Nelder 1989). This is reconstructed as the sum of the
linear predictor and the working residuals — with the latter comprising the
error of the model on the link scale. The advantage of this approach is
that a relatively straightforward 'transformation' of any non-gaussian
response is readily attainable in all cases. The standard deviation (or
other relevant range) can then be calculated using values of the
transformed response and used to scale the effects. An additional benefit
for piecewise SEMs is that the transformed rather than original response
can be specified as a predictor in other models, ensuring that standardised
indirect and total effects are calculated correctly (i.e. using the same
units).</p>
<p>To ensure a high level of 'accuracy' in the working response – in the sense
that the inverse-transformation is practically indistinguishable from the
original response variable – the function uses the following iterative
fitting procedure to calculate a 'final' working response:</p><ol>
<li><p>A new GLM of the same error family is fit with the original response
variable as both predictor and response, and using a single IRLS iteration.</p></li>
<li><p>The working response is reconstructed from this model.</p></li>
<li><p>The inverse transformation of the working response is calculated.</p></li>
<li><p>If the inverse transformation is 'effectively equal' to the original
response (tested using <code><a href='https://rdrr.io/r/base/all.equal.html'>all.equal()</a></code> with the default tolerance of
<code>1.5e-8</code>), the working response is returned; otherwise, the GLM is refit
with the working response now as the predictor, and steps 2-4 are repeated
— each time with an additional IRLS iteration.</p></li>
</ol>

<p>This approach will generate a very reasonable transformation of the
response variable, which will also be practically indistinguishable from
the direct transformation, where this can be compared (see Examples). It
also ensures that the transformed values, and hence the standard deviation,
are the same for any GLM fitting the same response (provided it uses the
same link function) — facilitating model comparisons, selection, and
averaging.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>As we often cannot directly observe the GLM response variable on the
link scale, any method estimating its values or statistics will be wrong to
some degree. The heuristic approach described here aims to reduce this
error as far as (reasonably) possible, while also generating standardised
effects whose interpretation most closely resembles those of the ordinary
linear model. The solution of using the working response from the GLM to
scale effects is a practical, but reasonable one, and one that takes
advantage of modern computing power to minimise error through iterative
model fitting. An added bonus is that the estimated variance is constant
across models fit to the same response variable, which cannot be said of
previous methods (Menard 2011). The overall approach would be classed as
'observed-empirical' by Grace <em>et al.</em> (2018), as it utilises model error
variance (the estimated working residuals) rather than theoretical
distribution-specific variance.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Grace, J.B., Johnson, D.J., Lefcheck, J.S. and Byrnes, J.E.K.
(2018) Quantifying relative importance: computing standardized effects in
models with binary outcomes. <em>Ecosphere</em>, <strong>9</strong>, e02283. doi: <a href='https://doi.org/10/gdm5bj'>10/gdm5bj</a></p>
<p>McCullagh P. and Nelder, J. A. (1989) <em>Generalized Linear Models</em> (2nd
Edition). London: Chapman and Hall.</p>
<p>McKelvey, R. D., &amp; Zavoina, W. (1975). A statistical model for the analysis
of ordinal level dependent variables. <em>The Journal of Mathematical
Sociology</em>, <strong>4</strong>(1), 103-120. doi: <a href='https://doi.org/10/dqfhpp'>10/dqfhpp</a></p>
<p>Menard, S. (2011) Standards for Standardized Logistic Regression
Coefficients. <em>Social Forces</em>, <strong>89</strong>, 1409-1428. doi: <a href='https://doi.org/10/bvxb6s'>10/bvxb6s</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Compare estimate with a direct link transformation</span>
<span class='co'># (test with a poisson variable, log link)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>13</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span><span class='op'>(</span><span class='fl'>30</span>, lambda <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='va'>yl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='fu'>glt</span><span class='op'>(</span><span class='va'>y</span>, force.est <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Effectively equal?</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>yl</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># TRUE</span>

<span class='co'># Actual difference...</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>yl</span>, tolerance <span class='op'>=</span> <span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Mean relative difference: 2.489317e-10"</div><div class='input'><span class='co'># "Mean relative difference: 2.489317e-10"</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mark Murphy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


