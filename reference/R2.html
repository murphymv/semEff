<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>(Pseudo) R-squared — R2 • semEff</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="(Pseudo) R-squared — R2" />
<meta property="og:description" content="Calculate (Pseudo) R-squared for a fitted model, defined here as
the squared multiple correlation between the observed and fitted values for
the response variable. 'Adjusted' and 'Predicted' versions are also
calculated (see Details)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semEff</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/semEff.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/murphymv/semEff/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>(Pseudo) R-squared</h1>
    <small class="dont-index">Source: <a href='https://github.com/murphymv/semEff/blob/main/R/stdEff-fun.R'><code>R/stdEff-fun.R</code></a></small>
    <div class="hidden name"><code>R2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate (Pseudo) R-squared for a fitted model, defined here as
the squared multiple correlation between the observed and fitted values for
the response variable. 'Adjusted' and 'Predicted' versions are also
calculated (see Details).</p>
    </div>

    <pre class="usage"><span class='fu'>R2</span><span class='op'>(</span>
  <span class='va'>mod</span>,
  data <span class='op'>=</span> <span class='cn'>NULL</span>,
  adj <span class='op'>=</span> <span class='cn'>TRUE</span>,
  pred <span class='op'>=</span> <span class='cn'>TRUE</span>,
  offset <span class='op'>=</span> <span class='cn'>FALSE</span>,
  re.form <span class='op'>=</span> <span class='cn'>NULL</span>,
  type <span class='op'>=</span> <span class='st'>"pearson"</span>,
  env <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mod</th>
      <td><p>A fitted model object, or a list or nested list of such objects.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>An optional dataset, used to first refit the model(s).</p></td>
    </tr>
    <tr>
      <th>adj, pred</th>
      <td><p>Logical. If <code>TRUE</code> (default), adjusted and/or predicted
R-squared are also returned (the latter is not available for all model
types).</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>Logical. If <code>TRUE</code>, include model offset(s) in the
calculations (i.e. in the response variable and fitted values).</p></td>
    </tr>
    <tr>
      <th>re.form</th>
      <td><p>For mixed models of class <code>"merMod"</code>, the formula for
random effects to condition on when generating fitted values used in the
calculation of R-squared. Defaults to <code>NULL</code>, meaning all random
effects are included. See <code><a href='https://rdrr.io/pkg/lme4/man/predict.merMod.html'>predict.merMod</a></code> for further
specification details.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The type of correlation coefficient to use. Can be either
<code>"pearson"</code> (default) or <code>"spearman"</code>.</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>Environment in which to look for model data (if none supplied).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric vector of the R-squared value(s), or an array, list of
vectors/arrays, or nested list.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Various approaches to the calculation of a goodness of fit measure
for GLMs analogous to R-squared in the ordinary linear model have been
proposed. Generally termed 'pseudo R-squared' measures, they include
variance-based, likelihood-based, and distribution-specific approaches.
Here however, a more straightforward definition is used, which can be
applied to any model for which fitted values of the response variable are
generated: R-squared is calculated as the squared (weighted) correlation
between the observed and fitted values of the response (in the original
units). This is simply the squared version of the correlation measure
advocated by Zheng &amp; Agresti (2000), itself an intuitive measure of
goodness of fit describing the predictive power of a model. As the measure
does not depend on any specific error distribution or model estimating
procedure, it is also generally comparable across many different types of
model (Kvalseth 1985). In the case of the ordinary linear model, the
measure equals the more traditional R-squared based on sums of squares.</p>
<p>If <code>adj = TRUE</code> (default), the 'adjusted' R-squared value is also
returned, which provides an estimate of the population - as opposed to
sample - R-squared. This is achieved via an analytical formula which
adjusts R-squared for the 'degrees of freedom' of the model (i.e. the ratio
of observations to parameters). Here, this is calculated via the 'Pratt'
rather than standard 'Ezekiel/Wherry' formula, shown in a previous
simulation to be the most effective of a range of existing formulas at
estimating the population R-squared across a range of model specification
scenarios (Yin &amp; Fan 2001). Adjusted R-squared can be used to safeguard
against overfitting of the model to the original sample.</p>
<p>If <code>pred = TRUE</code> (default), a 'predicted' R-squared is also returned,
which is calculated via the same formula as for R-squared but using
cross-validated rather than standard fitted values. These are obtained by
dividing the model response residuals by the complement of the observation
leverages (diagonals of the hat matrix), then subtracting these inflated
'predicted' residuals from the response variable. This is essentially a
short cut to obtaining out-of-sample predictions, normally arising via a
leave-one-out cross-validation procedure (in a GLM they will not be exactly
equal to such predictions). The resulting R-squared is an estimate of the
R-squared that would occur were the model to be fit to new data, and will
be lower than the original - and likely also the adjusted - R-squared,
highlighting the loss of explanatory power when predicting to new data.
This measure is a variant of an
<a href='https://www.r-bloggers.com/2014/05/can-we-do-better-than-r-squared/'>existing
one</a>, calculated by substituting the 'PRESS' statistic, i.e. the sum of
squares of the predicted residuals (Allen 1974), for the residual sum of
squares in the classic R-squared formula.</p>
<p>For models fitted with one or more offsets, these will be removed by
default from the response variable and fitted values prior to calculations.
Thus R-squared will measure goodness of fit only for the predictors with
estimated, rather than fixed, coefficients. This is likely to be the
intended behaviour in most circumstances, though if users wish to include
variation due to the offset(s) they can set <code>offset = TRUE</code>.</p>
<p>For mixed models, the function will, by default, calculate all R-squared
measures using fitted values incorporating both the fixed and random
effects, thus encompassing all variation captured by the model. This is
equivalent to the 'conditional' R-squared of Nakagawa <em>et al.</em> (2017).
To include only some or no random effects, simply set the appropriate
formula using the argument <code>re.form</code>, which is passed directly to
<code>predict.merMod</code>. If <code>re.form = NA</code>, R-squared is calculated for
the fixed effects only - equivalent to the 'marginal' R-squared of Nakagawa
<em>et al.</em> (2017).</p>
<p>As R-squared is calculated here as a squared correlation, the <code>type</code>
of correlation coefficient can also be specified. Setting this to
<code>"spearman"</code> may be desirable in some cases, such as where the
relationship between response and fitted values is not necessarily
bivariate normal or linear. Note that R-squared based on Spearman's rho
(i.e. ranked variables) is not equivalent to the classic R-squared based on
sums of squares, but can still be considered a
<a href='https://stats.stackexchange.com/questions/44268/reporting-coefficient-of-determination-using-spearmans-rho'>useful
goodness of fit measure</a>. It may also be considered more appropriate for
comparisons of R-squared between GLMs and ordinary linear models in some
situations.</p>
<p>R-squared values produced by this function will always be bounded between
zero (no fit) and one (perfect fit), meaning that any negative values
arising from calculations will be rounded up to zero. Negative values
typically mean that the fit is 'worse' than the null expectation of no
relationship between the variables, which can be difficult to interpret in
practice and in any case usually only occurs in rare situations, such as
where the intercept is suppressed. Hence, for simplicity and ease of
interpretation, values less than zero are presented here as a complete lack
of model fit.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Caution must be exercised in interpreting the values of any pseudo
R-squared measure calculated for a GLM or mixed model (including those
produced by this function), as such measures do not hold all the properties
of R-squared in the ordinary linear model and as such may not always behave
as expected. Care must also be taken in comparing the measures to their
equivalents from ordinary linear models, particularly the adjusted and
predicted versions. For example, for the adjusted R-squared for mixed
models, it's not entirely clear what the sample size (n) in the formula
should represent - no. of observations? independent groups? something else?
(the default interpretation of no. of observations is used). With all that
being said, the value of standardised R-squared measures for even 'rough'
model fit assessment and comparison may outweigh such reservations, and the
adjusted and predicted versions in particular may aid the user in
diagnosing and preventing overfitting. They should NOT, however, replace
other measures such as AIC or BIC for formally comparing and/or ranking
competing models fit to the same response variable.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Allen, D. M. (1974). The Relationship Between Variable Selection
and Data Augmentation and a Method for Prediction. <em>Technometrics</em>,
<strong>16</strong>(1), 125-127. <a href='https://doi.org/gfgv57'>https://doi.org/gfgv57</a></p>
<p>Kvalseth, T. O. (1985) Cautionary Note about R2. <em>The American
Statistician</em>, <strong>39</strong>(4), 279-285. <a href='https://doi.org/b8b782'>https://doi.org/b8b782</a></p>
<p>Nakagawa, S., Johnson, P.C.D. and Schielzeth, H. (2017) The coefficient of
determination R2 and intra-class correlation coefficient from generalized
linear mixed-effects models revisited and expanded. <em>Journal of the
Royal Society Interface</em> <strong>14</strong>(134). <a href='https://doi.org/gddpnq'>https://doi.org/gddpnq</a></p>
<p>Yin, P. and Fan, X. (2001) Estimating R2 Shrinkage in Multiple Regression:
A Comparison of Different Analytical Methods. <em>The Journal of
Experimental Education</em> <strong>69</strong>(2), 203-224.
<a href='https://doi.org/fbdq5g'>https://doi.org/fbdq5g</a></p>
<p>Zheng, B. and Agresti, A. (2000) Summarizing the predictive power of a
generalized linear model. <em>Statistics in Medicine</em> <strong>19</strong>(13),
1771-1781. <a href='https://doi.org/db7rfv'>https://doi.org/db7rfv</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Pseudo R-squared for mixed models</span>
<span class='fu'>R2</span><span class='op'>(</span><span class='va'>Shipley.SEM</span><span class='op'>)</span>  <span class='co'># fixed + random ('conditional')</span>
</div><div class='output co'>#&gt; $DD
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.7080083        0.7074789        0.6835636 
#&gt; 
#&gt; $Date
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.9855557        0.9855351        0.9820241 
#&gt; 
#&gt; $Growth
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.7938367        0.7934878        0.7552854 
#&gt; 
#&gt; $Live
#&gt;     (r.squared) (adj.r.squared) 
#&gt;       0.2668652       0.2655969 
#&gt; </div><div class='input'><span class='fu'>R2</span><span class='op'>(</span><span class='va'>Shipley.SEM</span>, re.form <span class='op'>=</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>tree</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># fixed + 'tree'</span>
</div><div class='output co'>#&gt; $DD
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.5305163        0.5295480        0.4898536 
#&gt; 
#&gt; $Date
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.8491536        0.8489101        0.6831439 
#&gt; 
#&gt; $Growth
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.6068561        0.6060875        0.5012969 
#&gt; 
#&gt; $Live
#&gt;     (r.squared) (adj.r.squared) 
#&gt;       0.2453019       0.2439735 
#&gt; </div><div class='input'><span class='fu'>R2</span><span class='op'>(</span><span class='va'>Shipley.SEM</span>, re.form <span class='op'>=</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>site</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># fixed + 'site'</span>
</div><div class='output co'>#&gt; $DD
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.6839237        0.6833400        0.6567506 
#&gt; 
#&gt; $Date
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.6925661        0.6920020        0.2541820 
#&gt; 
#&gt; $Growth
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.3081469        0.3065037        0.1153087 
#&gt; 
#&gt; $Live
#&gt;     (r.squared) (adj.r.squared) 
#&gt;       0.2016339       0.2001796 
#&gt; </div><div class='input'><span class='fu'>R2</span><span class='op'>(</span><span class='va'>Shipley.SEM</span>, re.form <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>  <span class='co'># fixed only ('marginal')</span>
</div><div class='output co'>#&gt; $DD
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.5012513        0.5002021        0.4578167 
#&gt; 
#&gt; $Date
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.4250445        0.4237734        0.0801710 
#&gt; 
#&gt; $Growth
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;       0.04814953       0.04554088       0.00000000 
#&gt; 
#&gt; $Live
#&gt;     (r.squared) (adj.r.squared) 
#&gt;       0.1834597       0.1819515 
#&gt; </div><div class='input'><span class='fu'>R2</span><span class='op'>(</span><span class='va'>Shipley.SEM</span>, re.form <span class='op'>=</span> <span class='cn'>NA</span>, type <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>  <span class='co'># using Spearman's rho</span>
</div><div class='output co'>#&gt; $DD
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.4043303        0.4029960        0.3008997 
#&gt; 
#&gt; $Date
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;        0.3919543        0.3905817        0.2992427 
#&gt; 
#&gt; $Growth
#&gt;      (r.squared)  (adj.r.squared) (pred.r.squared) 
#&gt;      0.048572025      0.045965097      0.001204466 
#&gt; 
#&gt; $Live
#&gt;     (r.squared) (adj.r.squared) 
#&gt;      0.04724129      0.04529932 
#&gt; </div><div class='input'>
<span class='co'># Predicted R-squared: compare cross-validated predictions calculated/</span>
<span class='co'># approximated via the hat matrix to standard method (leave-one-out)</span>

<span class='co'># Fit test models using Shipley data - compare lm vs glm</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>Shipley</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Live</span> <span class='op'>~</span> <span class='va'>Date</span> <span class='op'>+</span> <span class='va'>DD</span> <span class='op'>+</span> <span class='va'>lat</span>, <span class='va'>d</span><span class='op'>)</span>
<span class='co'># m &lt;- glm(Live ~ Date + DD + lat, binomial, d)</span>

<span class='co'># Manual CV predictions (leave-one-out)</span>
<span class='va'>cvf1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>m.ni</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>m</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>[</span><span class='op'>-</span><span class='va'>i</span>, <span class='op'>]</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>m.ni</span>, <span class='va'>d</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span>, type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>

<span class='co'># Short-cut via the hat matrix</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='getY.html'>getY</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span>
<span class='va'>cvf2</span> <span class='op'>&lt;-</span> <span class='va'>y</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>y</span> <span class='op'>-</span> <span class='va'>f</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Compare predictions (not exactly equal for GLMs)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>cvf1</span>, <span class='va'>cvf2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># lm: TRUE; glm: "Mean relative difference: 1.977725e-06"</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>cvf1</span>, <span class='va'>cvf2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1</div><div class='input'><span class='co'># lm: 1; glm: 0.9999987</span>

<span class='co'># NOTE: comparison not tested here for mixed models, as hierarchical data can</span>
<span class='co'># complicate the choice of an appropriate leave-one-out procedure. However,</span>
<span class='co'># there is no obvious reason why use of the leverage values (diagonals of the</span>
<span class='co'># hat matrix) to estimate CV predictions shouldn't generalise, roughly, to</span>
<span class='co'># the mixed model case (at least for LMMs). In any case, users should</span>
<span class='co'># exercise the appropriate caution in interpretation.</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mark Murphy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


