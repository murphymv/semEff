<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bootstrap Effects — bootEff • semEff</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Bootstrap Effects — bootEff" />
<meta property="og:description" content="Bootstrap model effects (standardised coefficients) and optional
SEM correlated errors." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semEff</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/semEff.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/murphymv/semEff/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap Effects</h1>
    <small class="dont-index">Source: <a href='https://github.com/murphymv/semEff/blob/main/R/bootEff-fun.R'><code>R/bootEff-fun.R</code></a></small>
    <div class="hidden name"><code>bootEff.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Bootstrap model effects (standardised coefficients) and optional
SEM correlated errors.</p>
    </div>

    <pre class="usage"><span class='fu'>bootEff</span><span class='op'>(</span>
  <span class='va'>mod</span>,
  <span class='va'>R</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  type <span class='op'>=</span> <span class='st'>"nonparametric"</span>,
  ran.eff <span class='op'>=</span> <span class='cn'>NULL</span>,
  cor.err <span class='op'>=</span> <span class='cn'>NULL</span>,
  catch.err <span class='op'>=</span> <span class='cn'>TRUE</span>,
  parallel <span class='op'>=</span> <span class='st'>"snow"</span>,
  ncpus <span class='op'>=</span> <span class='cn'>NULL</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  bM.arg <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mod</th>
      <td><p>A fitted model object, or a list or nested list of such objects.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>Number of bootstrap resamples to generate.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Seed for the random number generator. If not provided, a random
five-digit integer is used (see Details).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The type of bootstrapping to perform. Can be
<code>"nonparametric"</code> (default), <code>"parametric"</code>, or
<code>"semiparametric"</code> (the last two currently only for mixed models, via
<code>bootMer</code>).</p></td>
    </tr>
    <tr>
      <th>ran.eff</th>
      <td><p>For nonparametric bootstrapping of mixed models, the name of
the (highest-level) random effect to resample (see Details).</p></td>
    </tr>
    <tr>
      <th>cor.err</th>
      <td><p>Optional, names of SEM correlated errors to be bootstrapped.
Should be of the form: <code><a href='https://rdrr.io/r/base/c.html'>c("mod1 ~~ mod2", "mod3 ~~ mod4", ...)</a></code>
(spaces optional), with names matching model names.</p></td>
    </tr>
    <tr>
      <th>catch.err</th>
      <td><p>Logical, should errors generated during model fitting or
estimation be caught and <code>NA</code> returned for estimates? If <code>FALSE</code>,
any such errors will cause the function to exit.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>The type of parallel processing to use. Can be one of
<code>"snow"</code>, <code>"multicore"</code>, or <code>"no"</code> (for none).</p></td>
    </tr>
    <tr>
      <th>ncpus</th>
      <td><p>Number of system cores to use for parallel processing. If
<code>NULL</code> (default), all available cores are used.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>Optional cluster to use if <code>parallel = "snow"</code>. If <code>NULL</code>
(default), a local cluster is created using the specified number of cores.</p></td>
    </tr>
    <tr>
      <th>bM.arg</th>
      <td><p>A named list of any additional arguments to <code>bootMer</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments to <code><a href='stdEff.html'>stdEff</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"boot"</code> containing the bootstrapped effects,
or a list/nested list of such objects.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>bootEff</code> uses the <code><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot</a></code> function
(primarily) to bootstrap standardised effects from a fitted model or list
of models (calculated using <code>stdEff</code>). Bootstrapping is typically
nonparametric, i.e. model effects are calculated from data where the rows
have been randomly sampled with replacement. 10,000 such resamples should
provide accurate coverage for confidence intervals in most situations, with
fewer sufficing in some cases. To ensure that data is resampled in the same
way across individual bootstrap operations within the same run (e.g. models
in a list), the same seed is set per operation, with the value saved as an
attribute to the matrix of bootstrapped values (for reproducibility). The
seed can either be user-supplied or a randomly-generated five-digit number
(default), and is always re-initialised on exit (i.e.
<code><a href='https://rdrr.io/r/base/Random.html'>set.seed(NULL)</a></code>).</p>
<p>Where <code>weights</code> are specified, bootstrapped effects will be a weighted
average across the set of candidate models for each response variable,
calculated after each model is first refit to the resampled dataset
(specifying <code>weights = "equal"</code> will use a simple average instead -
see <code><a href='avgEst.html'>avgEst</a></code>). If no weights are specified and
<code>mod</code> is a nested list of models, the function will throw an error, as
it will be expecting weights for a presumed model averaging scenario. If
instead the user wishes to bootstrap each individual model, they should
recursively apply the function using <code>rMapply</code> (remember to set a
seed).</p>
<p>Where names of models with correlated errors are specified to
<code>cor.err</code>, the function will also return bootstrapped Pearson
correlated errors (weighted residuals) for those models. If <code>weights</code>
are supplied and <code>mod</code> is a nested list, residuals will first be
averaged across candidate models. If any two models (or candidate sets)
with correlated errors were fit to different subsets of data observations,
both models/sets are first refit to data containing only the observations
in common.</p>
<p>For nonparametric bootstrapping of mixed models, resampling should occur at
the group-level, as individual observations are not independent. The name
of the random effect to resample must be supplied to <code>ran.eff</code>. For
nested random effects, this should be the highest-level group (Davison &amp;
Hinkley 1997, Ren <em>et al.</em> 2010). This form of resampling will result
in differently-sized datasets if observations are unbalanced across groups;
however this should not generally be an issue, as the number of independent
units (groups), and hence the 'degrees of freedom', remains
<a href='https://stats.stackexchange.com/questions/46965/bootstrapping-unbalanced-clustered-data-non-parametric-bootstrap'>unchanged</a>.</p>
<p>For mixed models with
<a href='https://stats.stackexchange.com/questions/228800/crossed-vs-nested-random-effects-how-do-they-differ-and-how-are-they-specified'>non-nested
random effects</a>, nonparametric resampling will not be appropriate. In these
cases, (semi-)parametric bootstrapping can be performed instead via
<code><a href='https://rdrr.io/pkg/lme4/man/bootMer.html'>bootMer</a></code> in the <span class="pkg">lme4</span> package (with additional
arguments passed to that function as necessary). NOTE: As <code>bootMer</code>
takes only a fitted model as its first argument, any model averaging is
calculated 'post-hoc' using the estimates in boot objects for each
candidate model, rather than during the bootstrapping process itself (i.e.
the default procedure via <code>boot</code>). Results are then returned in a new
boot object for each response variable or correlated error estimate.</p>
<p>If supplied a list containing both mixed and non-mixed models,
<code>bootEff</code> with nonparametric bootstrapping will still work and will
treat all models as mixed for resampling (with a warning). This is probably
a relatively rare scenario, but may occur where the user decides that
non-mixed models perform similarly and/or cause less issues than their
mixed counterparts for at least some response variables (e.g. where random
effect variance estimates are at or near zero). If nonparametric
bootstrapping is not used however, an error will occur, as <code>bootMer</code>
will only accept mixed models.</p>
<p>Parallel processing is used by default via the <span class="pkg">parallel</span> package and
option <code>parallel = "snow"</code> (and is generally recommended), but users
can specify the type of parallel processing to use, or none. If
<code>"snow"</code>, a cluster of workers is created using <code>makeCluster</code>,
and the user can specify the number of system cores to incorporate in the
cluster (defaults to all available). <code>bootEff</code> then exports all
required objects and functions to this cluster using <code>clusterExport</code>,
after performing a (rough) match of all objects and functions in the
current global environment to those referenced in the model call(s). Users
should load any required external packages prior to calling the function.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Bootstrapping mixed (or indeed any other) models may take a very long
time when the number of replicates, observations, parameters, and/or models
is high. To decrease processing time, it may be worth trying different
optimizers and/or other options to generate faster estimates (always check
results).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Burnham, K. P., &amp; Anderson, D. R. (2002). <em>Model Selection
and Multimodel Inference: A Practical Information-Theoretic Approach</em> (2nd
ed.). New York: Springer-Verlag. Retrieved from
<a href='https://www.springer.com/gb/book/9780387953649'>https://www.springer.com/gb/book/9780387953649</a></p>
<p>Davison, A. C., &amp; Hinkley, D. V. (1997). <em>Bootstrap Methods and their
Application</em>. Cambridge University Press.</p>
<p>Ren, S., Lai, H., Tong, W., Aminzadeh, M., Hou, X., &amp; Lai, S. (2010).
Nonparametric bootstrapping for hierarchical data. <em>Journal of Applied
Statistics</em>, <strong>37</strong>(9), 1487–1498. <a href='https://doi.org/dvfzcn'>https://doi.org/dvfzcn</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Bootstrap Shipley SEM (test)</span>
<span class='co'># (set 'site' as group for resampling - highest-level random effect)</span>
<span class='fu'>bootEff</span><span class='op'>(</span><span class='va'>Shipley.SEM</span>, ran.eff <span class='op'>=</span> <span class='st'>"site"</span>, R <span class='op'>=</span> <span class='fl'>1</span>, parallel <span class='op'>=</span> <span class='st'>"no"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>boundary (singular) fit: see ?isSingular</span></div><div class='output co'>#&gt; $DD
#&gt; 
#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = x, statistic = s, R = R, parallel = p, ncpus = nc, 
#&gt;     cl = cl)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;        original      bias    std. error
#&gt; t1* -0.05600661 -0.02744502          NA
#&gt; t2* -0.68772025 -0.03361506          NA
#&gt; 
#&gt; $Date
#&gt; 
#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = x, statistic = s, R = R, parallel = p, ncpus = nc, 
#&gt;     cl = cl)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;        original      bias    std. error
#&gt; t1* -0.01493651  0.01036119          NA
#&gt; t2* -0.62813666 -0.01014329          NA
#&gt; 
#&gt; $Growth
#&gt; 
#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = x, statistic = s, R = R, parallel = p, ncpus = nc, 
#&gt;     cl = cl)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;       original      bias    std. error
#&gt; t1* -0.2917507 -0.09291690          NA
#&gt; t2*  0.3824224  0.08838097          NA
#&gt; 
#&gt; $Live
#&gt; 
#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP
#&gt; 
#&gt; 
#&gt; Call:
#&gt; boot::boot(data = x, statistic = s, R = R, parallel = p, ncpus = nc, 
#&gt;     cl = cl)
#&gt; 
#&gt; 
#&gt; Bootstrap Statistics :
#&gt;      original     bias    std. error
#&gt; t1* 0.3105220 0.14388091          NA
#&gt; t2* 0.3681961 0.06469882          NA
#&gt; </div><div class='input'>
<span class='co'># Estimates (use saved boot object, 10000 resamples)</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>Shipley.SEM.Boot</span>, <span class='st'>"[["</span>, <span class='fl'>1</span><span class='op'>)</span>  <span class='co'># original</span>
</div><div class='output co'>#&gt; $DD
#&gt; (Intercept)         lat 
#&gt; -0.05600661 -0.68772025 
#&gt; 
#&gt; $Date
#&gt; (Intercept)          DD 
#&gt; -0.01493651 -0.62813666 
#&gt; 
#&gt; $Growth
#&gt; (Intercept)        Date 
#&gt;  -0.2917507   0.3824224 
#&gt; 
#&gt; $Live
#&gt; (Intercept)      Growth 
#&gt;   0.3105220   0.3681961 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>Shipley.SEM.Boot</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>$</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># bootstrapped</span>
</div><div class='output co'>#&gt; $DD
#&gt;      (Intercept)        lat
#&gt; [1,] -0.17021879 -0.5054090
#&gt; [2,] -0.01103324 -0.7609901
#&gt; [3,] -0.10033566 -0.4928980
#&gt; [4,] -0.15312629 -0.7296608
#&gt; [5,] -0.11097619 -0.6053109
#&gt; [6,] -0.10156478 -0.7990547
#&gt; 
#&gt; $Date
#&gt;      (Intercept)         DD
#&gt; [1,] -0.02737978 -0.5661798
#&gt; [2,] -0.03161189 -0.6893927
#&gt; [3,] -0.05836160 -0.5543232
#&gt; [4,]  0.10072154 -0.6399231
#&gt; [5,] -0.01505325 -0.6170210
#&gt; [6,]  0.03482753 -0.6373668
#&gt; 
#&gt; $Growth
#&gt;      (Intercept)      Date
#&gt; [1,]  -0.2382040 0.4057726
#&gt; [2,]  -0.4081317 0.3880245
#&gt; [3,]  -0.1970780 0.3199524
#&gt; [4,]  -0.2171214 0.4645324
#&gt; [5,]  -0.1899416 0.3404280
#&gt; [6,]  -0.4492782 0.4561816
#&gt; 
#&gt; $Live
#&gt;      (Intercept)    Growth
#&gt; [1,]   0.5461418 0.5188558
#&gt; [2,]   0.6408434 0.5677783
#&gt; [3,]   0.4097068 0.4474758
#&gt; [4,]   0.2654245 0.2996560
#&gt; [5,]   0.2541603 0.3150650
#&gt; [6,]   0.4736550 0.4279492
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mark Murphy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


